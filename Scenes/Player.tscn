[gd_scene load_steps=63 format=3 uid="uid://d3mqa3yxkbmot"]

[ext_resource type="Script" uid="uid://8xaa7lu46t4g" path="res://Scripts/PlayerController.gd" id="1_kyqiw"]
[ext_resource type="Texture2D" uid="uid://0i7ikncgmjds" path="res://Sprites/Player/hamster.png" id="2_kyqiw"]
[ext_resource type="PackedScene" uid="uid://de5all3ajrwck" path="res://Scenes/ThrownNut.tscn" id="2_nn08x"]
[ext_resource type="Texture2D" uid="uid://c7x3ukwuxcs7o" path="res://Sprites/Particles/drunk_particles.png" id="3_gntrk"]
[ext_resource type="Script" uid="uid://babpw2llhagpv" path="res://addons/TimeRewinder/rewinder.gd" id="4_5ixxa"]
[ext_resource type="Texture2D" uid="uid://df76gpbhr5pbd" path="res://Sprites/Player/Air/hamster_air2.png" id="5_i2e8t"]
[ext_resource type="Texture2D" uid="uid://7lcyd6yw4quc" path="res://Sprites/Player/Drink/hamster_drink1.png" id="5_lyrkg"]
[ext_resource type="Script" uid="uid://25uq6brcn0fn" path="res://addons/TimeRewinder/rewind_property.gd" id="5_nn08x"]
[ext_resource type="Texture2D" uid="uid://d2l3syu5cfhmc" path="res://Sprites/Player/Drink/hamster_drink2.png" id="6_c43xd"]
[ext_resource type="Texture2D" uid="uid://igvw0x0kirar" path="res://Sprites/Player/Spin/hamster_spin1.png" id="6_lslt6"]
[ext_resource type="Texture2D" uid="uid://mnlxh8a5slfa" path="res://Sprites/Player/Walk/hamster_walk1.png" id="6_megsn"]
[ext_resource type="Texture2D" uid="uid://bnhmiykmttgh2" path="res://Sprites/Player/Dash/hamster_dash_sheet.png" id="7_8p516"]
[ext_resource type="Texture2D" uid="uid://clwb6fu0y7mqs" path="res://Sprites/Player/Drink/hamster_drink3.png" id="7_avx33"]
[ext_resource type="Texture2D" uid="uid://cxqqrjmhla05v" path="res://Sprites/Player/Air/hamster_air1.png" id="7_qidb7"]
[ext_resource type="Texture2D" uid="uid://c87ic3ueue0a4" path="res://Sprites/Player/Spin/hamster_spin2.png" id="7_ulo2v"]
[ext_resource type="Texture2D" uid="uid://bqovdvenwlycr" path="res://Sprites/Player/Walk/hamster_walk2.png" id="7_yoq75"]
[ext_resource type="Texture2D" uid="uid://mp02sd1fj3d4" path="res://Sprites/Player/Spin/hamster_spin3.png" id="8_1iu4k"]
[ext_resource type="Texture2D" uid="uid://iyeot8p1ue8a" path="res://Sprites/Player/Dash/hamster_dash1.png" id="8_fvoow"]
[ext_resource type="Texture2D" uid="uid://tnn0gkor7klf" path="res://Sprites/Player/Walk/hamster_walk3.png" id="8_ksbbd"]
[ext_resource type="Texture2D" uid="uid://bls3hclv4kj7o" path="res://Sprites/Player/Drink/hamster_drink4.png" id="8_rxg2u"]
[ext_resource type="Texture2D" uid="uid://cyyppdj7e3k4" path="res://Sprites/Player/Spin/hamster_spin4.png" id="9_m0x7a"]
[ext_resource type="Texture2D" uid="uid://bcgo3ar8ry154" path="res://Sprites/Player/Dash/hamster_dash2.png" id="9_v5fqo"]
[ext_resource type="Texture2D" uid="uid://ddmdyxepg5r6p" path="res://Sprites/Player/Drink/hamster_drink5.png" id="9_xixlo"]
[ext_resource type="Script" uid="uid://b6c0hiphk1ohy" path="res://Scripts/AnimationManager.gd" id="9_yoq75"]
[ext_resource type="Texture2D" uid="uid://cf71ik4tqc4p5" path="res://Sprites/Player/Spin/hamster_spin5.png" id="10_5v66d"]
[ext_resource type="Texture2D" uid="uid://wuad7nd0k4h3" path="res://Sprites/Player/Drink/hamster_drink6.png" id="10_bfbt0"]
[ext_resource type="Texture2D" uid="uid://cycvwesk6ue08" path="res://Sprites/Player/Dash/hamster_dash3.png" id="10_yf17c"]
[ext_resource type="Texture2D" uid="uid://btwjuf7duxsko" path="res://Sprites/Player/Dash/hamster_dash4.png" id="11_awd2i"]
[ext_resource type="Texture2D" uid="uid://hvld6lgbrdgk" path="res://Sprites/Player/Drink/hamster_drink7.png" id="11_wosd6"]
[ext_resource type="Texture2D" uid="uid://bm2kysin1c7xe" path="res://Sprites/Player/Spin/hamster_spin6.png" id="11_x63xi"]
[ext_resource type="Texture2D" uid="uid://bst30fcex8vyg" path="res://Sprites/Player/Spin/hamster_spin7.png" id="12_i2e8t"]
[ext_resource type="Texture2D" uid="uid://c01wpqbusjb0p" path="res://Sprites/Player/Dash/hamster_dash5.png" id="12_o2sks"]
[ext_resource type="Texture2D" uid="uid://bj56fyyajfynv" path="res://Sprites/Player/Dash/hamster_dash6.png" id="13_3rw25"]
[ext_resource type="Texture2D" uid="uid://bgkfxh8puo6rq" path="res://Sprites/Player/Dash/hamster_dash7.png" id="14_u4y2r"]
[ext_resource type="Texture2D" uid="uid://cf1ib325kaks8" path="res://Sprites/Player/Dash/hamster_dash8.png" id="15_tbv6f"]
[ext_resource type="Texture2D" uid="uid://c65634ac06im1" path="res://Sprites/Player/Walk/hamster_walk4.png" id="18_x63xi"]
[ext_resource type="Texture2D" uid="uid://bwykemji501wp" path="res://Sprites/Player/Walk/hamster_walk5.png" id="19_i2e8t"]
[ext_resource type="Texture2D" uid="uid://bjrltanv0vut6" path="res://Sprites/Player/hamster_cheeks.png" id="19_m0x7a"]
[ext_resource type="Texture2D" uid="uid://dlg6nqg80rju3" path="res://Sprites/Particles/dustparticles.png" id="23_i2e8t"]
[ext_resource type="PackedScene" uid="uid://csdut8ytbu0c5" path="res://Scenes/SoundPlayer.tscn" id="31_wosd6"]
[ext_resource type="AudioStream" uid="uid://cyh5tybdh6kci" path="res://Audio/Player/sfx_step_grass_l.wav" id="32_avx33"]
[ext_resource type="AudioStream" uid="uid://cbpbg8i5l3oml" path="res://Audio/Player/03_Step_grass_03.wav" id="33_rxg2u"]
[ext_resource type="AudioStream" uid="uid://cc54x1ws3y0cl" path="res://Audio/Player/45_Landing_01.wav" id="34_xixlo"]
[ext_resource type="AudioStream" uid="uid://eunun76qccys" path="res://Audio/Player/61_Hit_03.wav" id="35_bfbt0"]
[ext_resource type="AudioStream" uid="uid://p2t76rfgfwgm" path="res://Audio/Player/30_Jump_03.wav" id="36_hkrn1"]
[ext_resource type="AudioStream" uid="uid://dqpukigwr1u6s" path="res://Audio/Player/56_Attack_03.wav" id="37_wpo1r"]

[sub_resource type="Resource" id="Resource_52ee3"]
script = ExtResource("5_nn08x")
node_path = NodePath("..")
property_name = "position"
time_saved = 15.0
metadata/_custom_type_script = "uid://25uq6brcn0fn"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_kyqiw"]
size = Vector2(20, 18)

[sub_resource type="CanvasItemMaterial" id="CanvasItemMaterial_dewec"]
particles_animation = true
particles_anim_h_frames = 4
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="CanvasItemMaterial" id="CanvasItemMaterial_qidb7"]
particles_animation = true
particles_anim_h_frames = 5
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="Curve" id="Curve_1iu4k"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.299435, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), -3.08764, 0.0, 0, 0]
point_count = 3

[sub_resource type="CanvasItemMaterial" id="CanvasItemMaterial_70hv0"]
particles_animation = true
particles_anim_h_frames = 5
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="CanvasItemMaterial" id="CanvasItemMaterial_i2e8t"]
particles_animation = true
particles_anim_h_frames = 5
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="Curve" id="Curve_m0x7a"]
_limits = [0.0, 2.0, 0.0, 1.0]
_data = [Vector2(0, 0.787398), 0.0, 1.97426, 0, 0, Vector2(0.144068, 1.44348), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="CanvasItemMaterial" id="CanvasItemMaterial_pqity"]
particles_animation = true
particles_anim_h_frames = 7
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="Curve" id="Curve_opqna"]
_data = [Vector2(0, 0.5), 0.0, 0.00553661, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 2
metadata/_snap_enabled = true

[sub_resource type="CurveTexture" id="CurveTexture_00okb"]
curve = SubResource("Curve_opqna")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_6hr71"]
gravity = Vector3(0, 0, 0)
alpha_curve = SubResource("CurveTexture_00okb")
anim_speed_min = 1.0
anim_speed_max = 2.0

[sub_resource type="SpriteFrames" id="SpriteFrames_gntrk"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("8_fvoow")
}, {
"duration": 1.0,
"texture": ExtResource("9_v5fqo")
}, {
"duration": 1.0,
"texture": ExtResource("10_yf17c")
}, {
"duration": 1.0,
"texture": ExtResource("11_awd2i")
}, {
"duration": 1.0,
"texture": ExtResource("12_o2sks")
}, {
"duration": 1.0,
"texture": ExtResource("13_3rw25")
}, {
"duration": 1.0,
"texture": ExtResource("14_u4y2r")
}, {
"duration": 1.0,
"texture": ExtResource("15_tbv6f")
}],
"loop": true,
"name": &"dash",
"speed": 24.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("5_lyrkg")
}, {
"duration": 1.0,
"texture": ExtResource("6_c43xd")
}, {
"duration": 1.0,
"texture": ExtResource("7_avx33")
}, {
"duration": 1.0,
"texture": ExtResource("8_rxg2u")
}, {
"duration": 1.0,
"texture": ExtResource("9_xixlo")
}, {
"duration": 1.0,
"texture": ExtResource("10_bfbt0")
}, {
"duration": 1.0,
"texture": ExtResource("11_wosd6")
}],
"loop": false,
"name": &"drink",
"speed": 12.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("5_i2e8t")
}],
"loop": true,
"name": &"fall",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("2_kyqiw")
}],
"loop": true,
"name": &"idle",
"speed": 24.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("7_qidb7")
}],
"loop": true,
"name": &"rise",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("6_lslt6")
}, {
"duration": 1.0,
"texture": ExtResource("7_ulo2v")
}, {
"duration": 1.0,
"texture": ExtResource("8_1iu4k")
}, {
"duration": 1.0,
"texture": ExtResource("9_m0x7a")
}, {
"duration": 1.0,
"texture": ExtResource("10_5v66d")
}, {
"duration": 1.0,
"texture": ExtResource("11_x63xi")
}, {
"duration": 1.0,
"texture": ExtResource("12_i2e8t")
}],
"loop": true,
"name": &"spin",
"speed": 24.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("6_megsn")
}, {
"duration": 1.0,
"texture": ExtResource("7_yoq75")
}, {
"duration": 1.0,
"texture": ExtResource("8_ksbbd")
}, {
"duration": 1.0,
"texture": ExtResource("18_x63xi")
}, {
"duration": 1.0,
"texture": ExtResource("19_i2e8t")
}, {
"duration": 1.0,
"texture": ExtResource("18_x63xi")
}, {
"duration": 1.0,
"texture": ExtResource("8_ksbbd")
}, {
"duration": 1.0,
"texture": ExtResource("7_yoq75")
}],
"loop": true,
"name": &"walk",
"speed": 24.0
}]

[sub_resource type="Animation" id="Animation_qidb7"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(1, 1, 1, 1)]
}

[sub_resource type="Animation" id="Animation_i2e8t"]
resource_name = "damage_flash"
length = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Color(1, 0, 0, 1), Color(1, 1, 1, 1)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_70hv0"]
_data = {
&"RESET": SubResource("Animation_qidb7"),
&"damage_flash": SubResource("Animation_i2e8t")
}

[node name="Player" type="CharacterBody2D" node_paths=PackedStringArray("coyote_timer", "jump_buffer_timer", "short_jump_timer", "spin_timer", "i_frame_timer", "drink_timer", "pre_rewind_timer", "dash_timer", "my_sprite", "time_rewinder", "collision_shape", "animation_player", "drunk_particles", "jump_particles", "land_particles", "run_particles", "hit_particles", "afterimage_particles", "footsteps_sound", "landing_sound", "hurt_sound", "jump_sound")]
collision_layer = 2
script = ExtResource("1_kyqiw")
speed = 260.0
acceleration = 7.0
friction = 4.0
max_nut_count = 5
thrown_nut = ExtResource("2_nn08x")
rewindAcceleration = 5.0
coyote_timer = NodePath("Timers/CoyoteTimer")
jump_buffer_timer = NodePath("Timers/JumpBufferTimer")
short_jump_timer = NodePath("Timers/ShortJumpTimer")
spin_timer = NodePath("Timers/SpinTimer")
i_frame_timer = NodePath("Timers/IFrameTimer")
drink_timer = NodePath("Timers/DrinkTimer")
pre_rewind_timer = NodePath("Timers/PreRewindTimer")
dash_timer = NodePath("Timers/DashTimer")
my_sprite = NodePath("AnimatedSprite2D")
time_rewinder = NodePath("Rewinder")
collision_shape = NodePath("CollisionShape2D")
animation_player = NodePath("AnimatedSprite2D/AnimationPlayer")
drunk_particles = NodePath("Particles/DrunkParticles")
jump_particles = NodePath("Particles/JumpParticles")
land_particles = NodePath("Particles/LandParticles")
run_particles = NodePath("Particles/RunParticles")
hit_particles = NodePath("Particles/HitParticles")
afterimage_particles = NodePath("Particles/AfterimageParticles")
footsteps_sound = NodePath("Sounds/FootstepSound")
landing_sound = NodePath("Sounds/LandingSound")
hurt_sound = NodePath("Sounds/HurtSound")
jump_sound = NodePath("Sounds/JumpSound")

[node name="Rewinder" type="Node" parent="."]
script = ExtResource("4_5ixxa")
rewind_resources = Array[ExtResource("5_nn08x")]([SubResource("Resource_52ee3")])
speed_scale = 4.0
metadata/_custom_type_script = "uid://babpw2llhagpv"

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, -9)
shape = SubResource("RectangleShape2D_kyqiw")

[node name="Particles" type="Node2D" parent="."]

[node name="DrunkParticles" type="CPUParticles2D" parent="Particles"]
z_index = -1
material = SubResource("CanvasItemMaterial_dewec")
position = Vector2(0, -25)
amount = 4
texture = ExtResource("3_gntrk")
speed_scale = 0.5
emission_shape = 1
emission_sphere_radius = 10.0
gravity = Vector2(0, -100)
anim_speed_min = 1.0
anim_speed_max = 1.0

[node name="JumpParticles" type="CPUParticles2D" parent="Particles"]
material = SubResource("CanvasItemMaterial_qidb7")
emitting = false
amount = 4
texture = ExtResource("23_i2e8t")
lifetime = 0.6
one_shot = true
explosiveness = 1.0
direction = Vector2(0, -1)
spread = 90.0
gravity = Vector2(0, 400)
initial_velocity_min = 75.0
initial_velocity_max = 175.0
damping_min = 5.0
damping_max = 5.0
scale_amount_max = 2.0
scale_amount_curve = SubResource("Curve_1iu4k")
anim_speed_min = 1.0
anim_speed_max = 1.0

[node name="HitParticles" type="CPUParticles2D" parent="Particles"]
material = SubResource("CanvasItemMaterial_qidb7")
emitting = false
amount = 20
texture = ExtResource("23_i2e8t")
lifetime = 0.3
one_shot = true
explosiveness = 0.1
direction = Vector2(0, -1)
spread = 180.0
gravity = Vector2(0, 0)
initial_velocity_max = 75.0
damping_min = 5.0
damping_max = 5.0
scale_amount_min = 2.0
scale_amount_max = 4.0
scale_amount_curve = SubResource("Curve_1iu4k")
anim_speed_min = 0.5
anim_speed_max = 0.5

[node name="LandParticles" type="CPUParticles2D" parent="Particles"]
material = SubResource("CanvasItemMaterial_70hv0")
position = Vector2(0, 11)
emitting = false
amount = 4
texture = ExtResource("23_i2e8t")
lifetime = 0.7
one_shot = true
speed_scale = 1.2
explosiveness = 1.0
direction = Vector2(0, -1)
gravity = Vector2(0, 400)
initial_velocity_min = 150.0
initial_velocity_max = 250.0
damping_min = 1.0
damping_max = 5.0
scale_amount_max = 2.0
scale_amount_curve = SubResource("Curve_1iu4k")
anim_speed_min = 1.0
anim_speed_max = 1.0

[node name="RunParticles" type="CPUParticles2D" parent="Particles"]
material = SubResource("CanvasItemMaterial_i2e8t")
emitting = false
amount = 4
texture = ExtResource("23_i2e8t")
speed_scale = 2.0
gravity = Vector2(0, 0)
scale_amount_max = 2.0
scale_amount_curve = SubResource("Curve_m0x7a")
anim_speed_min = 1.0
anim_speed_max = 1.0

[node name="AfterimageParticles" type="GPUParticles2D" parent="Particles"]
material = SubResource("CanvasItemMaterial_pqity")
position = Vector2(0, -16)
emitting = false
amount = 16
texture = ExtResource("7_8p516")
lifetime = 0.25
process_material = SubResource("ParticleProcessMaterial_6hr71")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="." node_paths=PackedStringArray("player", "cheeks")]
sprite_frames = SubResource("SpriteFrames_gntrk")
animation = &"dash"
frame = 2
frame_progress = 0.798832
offset = Vector2(0, -16)
script = ExtResource("9_yoq75")
player = NodePath("..")
cheeks = NodePath("Cheeks")

[node name="Cheeks" type="Sprite2D" parent="AnimatedSprite2D"]
position = Vector2(0, -18)
texture = ExtResource("19_m0x7a")

[node name="AnimationPlayer" type="AnimationPlayer" parent="AnimatedSprite2D"]
libraries = {
&"": SubResource("AnimationLibrary_70hv0")
}

[node name="Timers" type="Node2D" parent="."]

[node name="CoyoteTimer" type="Timer" parent="Timers"]
wait_time = 0.1
one_shot = true

[node name="JumpBufferTimer" type="Timer" parent="Timers"]
wait_time = 0.1
one_shot = true

[node name="ShortJumpTimer" type="Timer" parent="Timers"]
wait_time = 0.3
one_shot = true

[node name="SpinTimer" type="Timer" parent="Timers"]
wait_time = 0.5
one_shot = true

[node name="IFrameTimer" type="Timer" parent="Timers"]
wait_time = 0.6
one_shot = true

[node name="DrinkTimer" type="Timer" parent="Timers"]
wait_time = 0.67
one_shot = true

[node name="PreRewindTimer" type="Timer" parent="Timers"]
wait_time = 0.67
one_shot = true

[node name="DashTimer" type="Timer" parent="Timers"]
wait_time = 0.3
one_shot = true

[node name="Sounds" type="Node2D" parent="."]

[node name="FootstepSound" parent="Sounds" instance=ExtResource("31_wosd6")]
volume_db = -5.0
sounds = [ExtResource("32_avx33"), ExtResource("33_rxg2u")]
sound_wait = 0.3

[node name="LandingSound" parent="Sounds" instance=ExtResource("31_wosd6")]
volume_db = 2.0
sounds = [ExtResource("34_xixlo")]

[node name="HurtSound" parent="Sounds" instance=ExtResource("31_wosd6")]
volume_db = 10.0
sounds = [ExtResource("35_bfbt0")]

[node name="JumpSound" parent="Sounds" instance=ExtResource("31_wosd6")]
volume_db = 1.5
sounds = [ExtResource("36_hkrn1"), ExtResource("37_wpo1r")]

[connection signal="timeout" from="Timers/PreRewindTimer" to="." method="_on_pre_rewind_timeout"]
